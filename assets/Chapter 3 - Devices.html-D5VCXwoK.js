import{_ as s,c as n,a,o as i}from"./app-BeHGwf2X.js";const d="/blog/assets/scsi-Biwu2BP6.png",l="/blog/assets/scsi-subsystem-DNJ7Klqp.png",r="/blog/assets/generic-driver-D9d4qebG.png",c={};function o(t,e){return i(),n("div",null,e[0]||(e[0]=[a(`<h1 id="chapter-3-devices" tabindex="-1"><a class="header-anchor" href="#chapter-3-devices"><span>Chapter 3 - Devices</span></a></h1><p>Created by : Mr Dk.</p><p>2019 / 06 / 15 10:46</p><p>@Nanjing, Jiangsu, China</p><hr><p>ç†è§£å½“å†…æ ¸å‘ç°æ–°è®¾å¤‡æ—¶ï¼Œå¦‚ä½•ä¸ç”¨æˆ·ç©ºé—´è¿›è¡Œäº¤äº’ã€‚udev ç³»ç»Ÿä½¿ç”¨æˆ·ç©ºé—´ç¨‹åºèƒ½å¤Ÿè‡ªåŠ¨é…ç½®å¹¶ä½¿ç”¨æ–°è®¾å¤‡ï¼Œå†…æ ¸å¦‚ä½•é€šè¿‡ udev å‘ç”¨æˆ·è¿›ç¨‹å‘æ¶ˆæ¯ï¼Ÿ</p><h2 id="_3-1-device-files" tabindex="-1"><a class="header-anchor" href="#_3-1-device-files"><span>3.1 Device Files</span></a></h2><p>Unix ç³»ç»Ÿä¸­å°†å¤§éƒ¨åˆ†è®¾å¤‡çš„ I/O æ¥å£è¡¨ç¤ºä¸ºæ–‡ä»¶ã€‚è¿™äº›è®¾å¤‡æ–‡ä»¶æœ‰æ—¶è¢«ç§°ä¸º <em>device nodes</em>ã€‚</p><ul><li>ç”¨æˆ·å¯ä»¥ä½¿ç”¨æ™®é€šçš„æ–‡ä»¶æ“ä½œä½¿ç”¨è®¾å¤‡</li><li>è®¾å¤‡ä¹Ÿå¯ä»¥è¢«ä¸€äº›æ“ä½œæ–‡ä»¶çš„æ ‡å‡†ç¨‹åºä½¿ç”¨ (cat ç­‰)</li></ul><p>ä½†å¹¶ä¸æ˜¯æ‰€æœ‰è®¾å¤‡éƒ½å¯ä»¥é€šè¿‡æ ‡å‡†æ–‡ä»¶ I/O æ¥ä½¿ç”¨ã€‚åœ¨ Linux ä¸­ï¼Œè®¾å¤‡æ–‡ä»¶ä½äº <code>/dev</code> ç›®å½•ä¸‹ï¼Œè¿è¡Œå‘½ä»¤å¯ä»¥æŸ¥çœ‹æ‰€æœ‰çš„è®¾å¤‡æ–‡ä»¶ï¼š</p><div class="language-console line-numbers-mode" data-highlighter="prismjs" data-ext="console" data-title="console"><pre><code><span class="line">[root@izuf6ewwd5zlnpjggtr0b4z ~]# ls -l /dev/</span>
<span class="line">total 0</span>
<span class="line">crw------- 1 root root     10, 235 Jan  5 23:56 autofs</span>
<span class="line">drwxr-xr-x 2 root root          80 Jan  6 07:56 block</span>
<span class="line">crw------- 1 root root     10, 234 Jan  5 23:56 btrfs-control</span>
<span class="line">drwxr-xr-x 3 root root          60 Jan  5 23:56 bus</span>
<span class="line">drwxr-xr-x 2 root root        2620 Jan  5 23:56 char</span>
<span class="line">crw------- 1 root root      5,   1 Jan  5 23:56 console</span>
<span class="line">lrwxrwxrwx 1 root root          11 Jan  6 07:56 core -&gt; /proc/kcore</span>
<span class="line">drwxr-xr-x 3 root root          80 Jan  5 23:56 cpu</span>
<span class="line">crw------- 1 root root     10,  61 Jan  5 23:56 cpu_dma_latency</span>
<span class="line">crw------- 1 root root     10,  62 Jan  5 23:56 crash</span>
<span class="line">drwxr-xr-x 4 root root          80 Jan  6 07:56 disk</span>
<span class="line">drwxr-xr-x 2 root root          80 Jan  6 07:56 dri</span>
<span class="line">crw-rw---- 1 root video    29,   0 Jan  5 23:56 fb0</span>
<span class="line">lrwxrwxrwx 1 root root          13 Jan  6 07:56 fd -&gt; /proc/self/fd</span>
<span class="line">crw-rw-rw- 1 root root      1,   7 Jan  5 23:56 full</span>
<span class="line">crw-rw-rw- 1 root root     10, 229 Jan  5 23:56 fuse</span>
<span class="line">crw------- 1 root root    249,   0 Jan  5 23:56 hidraw0</span>
<span class="line">crw------- 1 root root     10, 228 Jan  5 23:56 hpet</span>
<span class="line">drwxr-xr-x 2 root root           0 Jan  5 23:56 hugepages</span>
<span class="line">crw------- 1 root root     10, 183 Jan  5 23:56 hwrng</span>
<span class="line">lrwxrwxrwx 1 root root          25 Jan  5 23:56 initctl -&gt; /run/systemd/initctl/fifo</span>
<span class="line">drwxr-xr-x 4 root root         280 Jan  5 23:56 input</span>
<span class="line">crw-r--r-- 1 root root      1,  11 Jan  5 23:56 kmsg</span>
<span class="line">srw-rw-rw- 1 root root           0 Jan  6 07:56 log</span>
<span class="line">crw-rw---- 1 root disk     10, 237 Jan  5 23:56 loop-control</span>
<span class="line">drwxr-xr-x 2 root root          60 Jan  5 23:56 mapper</span>
<span class="line">crw------- 1 root root     10, 227 Jan  5 23:56 mcelog</span>
<span class="line">crw-r----- 1 root kmem      1,   1 Jan  5 23:56 mem</span>
<span class="line">drwxrwxrwt 2 root root          40 Jan  5 23:56 mqueue</span>
<span class="line">drwxr-xr-x 2 root root          60 Jan  5 23:56 net</span>
<span class="line">crw------- 1 root root     10,  60 Jan  5 23:56 network_latency</span>
<span class="line">crw------- 1 root root     10,  59 Jan  5 23:56 network_throughput</span>
<span class="line">crw-rw-rw- 1 root root      1,   3 Jan  5 23:56 null</span>
<span class="line">crw------- 1 root root     10, 144 Jan  5 23:56 nvram</span>
<span class="line">crw------- 1 root root      1,  12 Jan  5 23:56 oldmem</span>
<span class="line">crw-r----- 1 root kmem      1,   4 Jan  5 23:56 port</span>
<span class="line">crw------- 1 root root    108,   0 Jan  5 23:56 ppp</span>
<span class="line">crw-rw-rw- 1 root tty       5,   2 Jun 14 13:58 ptmx</span>
<span class="line">drwxr-xr-x 2 root root           0 Jan  5 23:56 pts</span>
<span class="line">crw-rw-rw- 1 root root      1,   8 Jan  5 23:56 random</span>
<span class="line">drwxr-xr-x 2 root root          60 Jan  5 23:56 raw</span>
<span class="line">lrwxrwxrwx 1 root root           4 Jan  5 23:56 rtc -&gt; rtc0</span>
<span class="line">crw------- 1 root root    253,   0 Jan  5 23:56 rtc0</span>
<span class="line">drwxrwxrwt 2 root root          40 Jan  6 07:56 shm</span>
<span class="line">crw------- 1 root root     10, 231 Jan  5 23:56 snapshot</span>
<span class="line">drwxr-xr-x 2 root root          80 Jan  5 23:56 snd</span>
<span class="line">lrwxrwxrwx 1 root root          15 Jan  6 07:56 stderr -&gt; /proc/self/fd/2</span>
<span class="line">lrwxrwxrwx 1 root root          15 Jan  6 07:56 stdin -&gt; /proc/self/fd/0</span>
<span class="line">lrwxrwxrwx 1 root root          15 Jan  6 07:56 stdout -&gt; /proc/self/fd/1</span>
<span class="line">brw-rw---- 1 root disk    253,   0 Jan  5 23:56 vda</span>
<span class="line">brw-rw---- 1 root disk    253,   1 Jan  5 23:57 vda1</span>
<span class="line">drwxr-xr-x 2 root root          60 Jan  5 23:56 vfio</span>
<span class="line">crw------- 1 root root     10,  63 Jan  5 23:56 vga_arbiter</span>
<span class="line">crw------- 1 root root     10, 137 Jan  5 23:56 vhci</span>
<span class="line">crw------- 1 root root     10, 238 Jan  5 23:56 vhost-net</span>
<span class="line">drwxr-xr-x 2 root root          60 Jan  6 07:56 virtio-ports</span>
<span class="line">crw------- 1 root root    248,   1 Jan  5 23:56 vport1p1</span>
<span class="line">crw-rw-rw- 1 root root      1,   5 Jan  5 23:56 zero</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¯”å¦‚ï¼š</p><div class="language-console line-numbers-mode" data-highlighter="prismjs" data-ext="console" data-title="console"><pre><code><span class="line">$ echo emm &gt; /dev/null</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å°†è¾“å‡ºé‡å®šå‘åˆ°äº†ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œè€Œè¿™ä¸ªæ–‡ä»¶å®é™…ä¸Šå¯¹åº”äº†ä¸€ä¸ªè®¾å¤‡ã€‚ç”±å†…æ ¸æ¥å†³å®šå¦‚ä½•å¤„ç†å†™å…¥è¯¥è®¾å¤‡çš„æ•°æ®ã€‚å¯¹äº <code>/dev/null</code> æ¥è¯´ï¼Œå†…æ ¸ä¼šå¿½ç•¥æ‰€æœ‰çš„è¾“å…¥ï¼Œå¹¶å°†æ•°æ®ä¸¢æ‰...... ğŸ˜…</p><div class="language-console line-numbers-mode" data-highlighter="prismjs" data-ext="console" data-title="console"><pre><code><span class="line">$ ls -l</span>
<span class="line">brw-rw---- 1 root disk    253,   0 Jan  5 23:56 vda</span>
<span class="line">crw------- 1 root root     10, 235 Jan  5 23:56 autofs</span>
<span class="line">prw-r--r-- 1 root root           0 Mar  3 19:17 fdata</span>
<span class="line">srw-rw-rw- 1 root root           0 Jan  6 07:56 log</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>File mode çš„ç¬¬ä¸€ä¸ªå­—ç¬¦å¦‚æœæ˜¯ <code>b</code> / <code>c</code> / <code>p</code> / <code>s</code>ï¼Œé‚£ä¹ˆè¯¥æ–‡ä»¶å¯¹åº”ä¸€ä¸ªè®¾å¤‡ï¼š</p><ul><li><code>b</code> - block device</li><li><code>c</code> - character device</li><li><code>p</code> - pipe device</li><li><code>s</code> - socket device</li></ul><h3 id="block-device" tabindex="-1"><a class="header-anchor" href="#block-device"><span>Block Device</span></a></h3><p>ç¨‹åºä»¥å›ºå®šå¤§å°çš„ chunks ä» block device ä¸­è®¿é—®æ•°æ®ï¼Œæ¯”å¦‚ç£ç›˜è®¾å¤‡ã€‚ç”±äºæ¯ä¸ª chunk å¤§å°å›ºå®šï¼Œä¸”æ˜“äºç´¢å¼•ï¼Œè¿›ç¨‹å¯ä»¥åœ¨å†…æ ¸çš„å¸®åŠ©ä¸‹éšæœºè®¿é—® blockã€‚</p><h3 id="character-device" tabindex="-1"><a class="header-anchor" href="#character-device"><span>Character Device</span></a></h3><p>è¿™ç±»è®¾å¤‡çš„å·¥ä½œåŸºäº <strong>data streams</strong>ï¼Œåªèƒ½å¯¹è¿™ç±»è®¾å¤‡å†™å…¥å­—ç¬¦æˆ–è¯»å–å­—ç¬¦ã€‚è¿™ç±»è®¾å¤‡æ²¡æœ‰å¤§å°çš„æ¦‚å¿µï¼š</p><ul><li>åœ¨è¿›ç¨‹ä¸­è¿›è¡Œ read æˆ– write çš„è¡Œä¸ºæ—¶ï¼Œå†…æ ¸ä¼šé€šè¿‡é©±åŠ¨åœ¨è®¾å¤‡ä¸Šè¿›è¡Œ read æˆ– write æ“ä½œ</li><li>åœ¨æ•°æ®è¢«ä¼ è¾“åˆ°è®¾å¤‡æˆ–è€…è¿›ç¨‹ä¹‹åï¼Œå†…æ ¸ <strong>ä¸ä¼š</strong> å¤‡ä»½æˆ–é‡æ–°æ£€éªŒæ•°æ®æµ</li></ul><p>æ¯”å¦‚ <strong>æ‰“å°æœº</strong> å±äºè¿™ç±»è®¾å¤‡ã€‚</p><h3 id="pipe-device" tabindex="-1"><a class="header-anchor" href="#pipe-device"><span>Pipe Device</span></a></h3><p>è¿™ç±»è®¾å¤‡å’Œ character device è®¾å¤‡ç±»ä¼¼ï¼Œä½†æ˜¯ I/O stream çš„å¦ä¸€ç«¯æ˜¯å¦ä¸€ä¸ªè¿›ç¨‹ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå†…æ ¸é©±åŠ¨ã€‚</p><h3 id="socket-device" tabindex="-1"><a class="header-anchor" href="#socket-device"><span>Socket Device</span></a></h3><p>ç”¨äºè¿›ç¨‹é—´é€šä¿¡çš„ç‰¹æ®Šç”¨é€”æ¥å£ï¼Œé€šå¸¸åœ¨ <code>/dev</code> ç›®å½•ä¹‹å¤–ã€‚æ­¤å¤–ï¼Œå‰ä¸¤è¡Œä¸­æ—¥æœŸä¹‹å‰çš„ä¸¤ä¸ªæ•°å­—æ˜¯è®¾å¤‡çš„ä¸»è¦ç¼–å·å’Œæ¬¡è¦ç¼–å·ï¼Œå¸®åŠ©å†…æ ¸è¯†åˆ«è®¾å¤‡ã€‚ç±»ä¼¼çš„è®¾å¤‡é€šå¸¸éƒ½æœ‰ç±»ä¼¼çš„ä¸»è¦ç¼–å·ã€‚<strong>ä¸æ˜¯æ‰€æœ‰çš„è®¾å¤‡éƒ½æœ‰è®¾å¤‡æ–‡ä»¶ï¼Œå› ä¸ºæ–‡ä»¶ I/O æ¥å£ä¸é€‚ç”¨äºæ‰€æœ‰çš„åœºæ™¯ã€‚</strong></p><h2 id="_3-2-the-sysfs-device-path" tabindex="-1"><a class="header-anchor" href="#_3-2-the-sysfs-device-path"><span>3.2 The sysfs Device Path</span></a></h2><p><code>/dev</code> ç›®å½•ä¸­åªæœ‰å¾ˆå°‘ä¸€éƒ¨åˆ†çš„è®¾å¤‡ä¿¡æ¯ã€‚Linux å†…æ ¸é€šè¿‡ sysfs æ¥å£ï¼Œé€šè¿‡æ–‡ä»¶å’Œç›®å½•ï¼Œæä¾›äº†æŸ¥çœ‹è®¾å¤‡çœŸå®ç¡¬ä»¶å‚æ•°çš„ç»Ÿä¸€è§†è§’ã€‚åŸºè·¯å¾„ä½äº <code>/sys/devices</code>ï¼š</p><ul><li><code>/dev</code> ä½¿ç”¨æˆ·è¿›ç¨‹èƒ½å¤Ÿä½¿ç”¨è®¾å¤‡</li><li><code>/sys/devices</code> ç”¨äºæŸ¥çœ‹ä¿¡æ¯å’Œç®¡ç†è®¾å¤‡</li><li>å…¶ä¸­å¯èƒ½åŒ…å«å¾ˆå¤šçš„ç¬¦å·é“¾æ¥ï¼Œæ‰€ä»¥éœ€è¦ç”¨ <code>ls -l</code> æ¥æŸ¥çœ‹çœŸå® sysfs è·¯å¾„</li></ul><p>åœ¨ <code>/sys/devices</code> æŸ¥æ‰¾ <code>/dev</code> ä¸­çš„è·¯å¾„å¯èƒ½å¾ˆéš¾ï¼Œå¯ä»¥ä½¿ç”¨ <code>udevadm</code> å‘½ä»¤æŸ¥æ‰¾ï¼š(æ¯”å¦‚æŸ¥æ‰¾ <code>/dev/sda</code> åœ¨ sysfs ä¸‹çš„è·¯å¾„)ã€‚</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">udevadm info <span class="token parameter variable">--query</span><span class="token operator">=</span>all <span class="token parameter variable">--name</span><span class="token operator">=</span>/dev/sda</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="_3-3-dd-and-devices" tabindex="-1"><a class="header-anchor" href="#_3-3-dd-and-devices"><span>3.3 dd and Devices</span></a></h2><p><code>dd</code> ç¨‹åºåœ¨ block devices æˆ– character devices ä¸­éå¸¸æœ‰ç”¨ã€‚ç¨‹åºåŠŸèƒ½ï¼š</p><ul><li>ä»è¾“å…¥æµæˆ–è¾“å…¥æ–‡ä»¶ä¸­è¯»å–</li><li>å†™å…¥è¾“å‡ºæ–‡ä»¶æˆ–è¾“å‡ºæµ</li><li>å¯èƒ½é¡ºå¸¦åšä¸€äº›ç¼–ç è½¬æ¢å·¥ä½œ</li></ul><p><code>dd</code> ä»¥å›ºå®šå—å¤§å°æ‹·è´æ•°æ®ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">dd</span> <span class="token assign-left variable">if</span><span class="token operator">=</span>/dev/zero <span class="token assign-left variable">of</span><span class="token operator">=</span>new_file <span class="token assign-left variable">bs</span><span class="token operator">=</span><span class="token number">1024</span> <span class="token assign-left variable">count</span><span class="token operator">=</span><span class="token number">1</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><code>if=file</code> - the input file</li><li><code>of=file</code> - the output file</li><li><code>bs=size</code> - the block size <ul><li><code>ibs=size</code></li><li><code>obs=size</code></li><li>ç”¨äºè¾“å…¥è¾“å‡ºçš„ block size ä¸åŒ</li></ul></li><li><code>count=num</code> - the total number of blocks to copy</li><li><code>skip=num</code> - åœ¨è¾“å…¥æ–‡ä»¶æˆ–è¾“å…¥æµä¸­è·³è¿‡å‰ num ä¸ªå—ï¼Œä¸æ‹·è´åˆ°è¾“å‡ºä¸­</li></ul><p>å‚æ•°æ ¼å¼ä¸å…¶å®ƒ Unix å‘½ä»¤ä¸åŒï¼šIBM Job Control Language (JCL) styleã€‚</p><h2 id="_3-4-devices-name-summary" tabindex="-1"><a class="header-anchor" href="#_3-4-devices-name-summary"><span>3.4 Devices Name Summary</span></a></h2><h3 id="_3-4-1-hard-disks-dev-sd" tabindex="-1"><a class="header-anchor" href="#_3-4-1-hard-disks-dev-sd"><span>3.4.1 Hard Disks: /dev/sd*</span></a></h3><p>å†…æ ¸ä¸ºç£ç›˜ä¸Šçš„æ¯ä¸ªåˆ†åŒºåˆ†åˆ«åˆ›å»ºè®¾å¤‡æ–‡ä»¶ã€‚</p><h3 id="_3-4-2-cd-and-dvd-drivers-dev-sr" tabindex="-1"><a class="header-anchor" href="#_3-4-2-cd-and-dvd-drivers-dev-sr"><span>3.4.2 CD and DVD Drivers: /dev/sr*</span></a></h3><h3 id="_3-4-3-pata-hard-disks-dev-hd" tabindex="-1"><a class="header-anchor" href="#_3-4-3-pata-hard-disks-dev-hd"><span>3.4.3 PATA Hard Disks: /dev/hd*</span></a></h3><h3 id="_3-4-4-terminals-dev-tty-dev-pts-and-dev-tty" tabindex="-1"><a class="header-anchor" href="#_3-4-4-terminals-dev-tty-dev-pts-and-dev-tty"><span>3.4.4 Terminals: /dev/tty*, /dev/pts/*, and /dev/tty</span></a></h3><h3 id="_3-4-5-serial-ports-dev-ttys" tabindex="-1"><a class="header-anchor" href="#_3-4-5-serial-ports-dev-ttys"><span>3.4.5 Serial Ports: /dev/ttyS*</span></a></h3><h3 id="_3-4-6-parallel-ports-dev-lp0-and-dev-lp1" tabindex="-1"><a class="header-anchor" href="#_3-4-6-parallel-ports-dev-lp0-and-dev-lp1"><span>3.4.6 Parallel Ports: /dev/lp0 and /dev/lp1</span></a></h3><h3 id="_3-4-7-audio-devices-dev-snd-dev-dsp-dev-audio-and-more" tabindex="-1"><a class="header-anchor" href="#_3-4-7-audio-devices-dev-snd-dev-dsp-dev-audio-and-more"><span>3.4.7 Audio Devices: /dev/snd/*, /dev/dsp, /dev/audio, and More</span></a></h3><h2 id="_3-5-udev" tabindex="-1"><a class="header-anchor" href="#_3-5-udev"><span>3.5 udev</span></a></h2><p>å†…æ ¸æ£€æµ‹åˆ°æ–°è®¾å¤‡ä»¥åï¼Œå‘ç”¨æˆ·ç©ºé—´è¿›ç¨‹ udevd å‘é€é€šçŸ¥ã€‚udevd æ£€æŸ¥æ–°è®¾å¤‡çš„å±æ€§ï¼Œåˆ›å»ºè®¾å¤‡æ–‡ä»¶ï¼Œå¹¶è¿›è¡Œè®¾å¤‡åˆå§‹åŒ–ã€‚é—®é¢˜ï¼šå¾ˆå¤šè®¾å¤‡åœ¨å¯åŠ¨è¿‡ç¨‹ä¸­å°±éœ€è¦è¢«ä½¿ç”¨ï¼Œæ‰€ä»¥ udevd å¿…é¡»å¾ˆæ—©å¯åŠ¨ã€‚ä¸ºäº†åˆ›å»ºè®¾å¤‡æ–‡ä»¶ï¼Œudevd ä¹Ÿä¸åº”è¯¥ä¾èµ–äºä»»ä½•å®ƒåº”è¯¥åˆ›å»ºçš„è®¾å¤‡æ–‡ä»¶ï¼›åŒæ—¶ï¼Œè¿˜éœ€è¦å¯åŠ¨è¿…é€Ÿï¼Œä»¥é˜²æ­¢ç³»ç»Ÿä¸ä¼šå› ä¸º udevd çš„å¯åŠ¨è€Œç­‰å¾…ã€‚</p><h3 id="_3-5-1-devtmpfs" tabindex="-1"><a class="header-anchor" href="#_3-5-1-devtmpfs"><span>3.5.1 devtmpfs</span></a></h3><p>devtmpfs æ–‡ä»¶ç³»ç»Ÿè¢«ç”¨äºè§£å†³ boot æœŸé—´è®¾å¤‡å¯ç”¨æ€§çš„é—®é¢˜ã€‚å†…æ ¸ä¼šåˆ›å»ºå¿…éœ€çš„è®¾å¤‡æ–‡ä»¶ï¼Œå¹¶é€šçŸ¥ udevd ä¸€ä¸ªæ–°è®¾å¤‡å¯ç”¨ã€‚åœ¨æ¥æ”¶åˆ°ä¿¡å·åï¼Œudevd ä¸åˆ›å»ºè®¾å¤‡æ–‡ä»¶ï¼Œä½†è¿›è¡Œè®¾å¤‡åˆå§‹åŒ–å’Œè¿›ç¨‹é€šçŸ¥ã€‚æ­¤å¤–ï¼Œè¿˜åœ¨ <code>/dev</code> ä¸­åˆ›å»ºç¬¦å·é“¾æ¥ç”¨äºè¯†åˆ«è®¾å¤‡ã€‚</p><h3 id="_3-5-2-udevd-operation-and-configuration" tabindex="-1"><a class="header-anchor" href="#_3-5-2-udevd-operation-and-configuration"><span>3.5.2 udevd Operation and Configuration</span></a></h3><p>udevd å®ˆæŠ¤è¿›ç¨‹çš„æ“ä½œè¿‡ç¨‹ï¼š</p><ol><li>å†…æ ¸é€šè¿‡å†…éƒ¨ç½‘ç»œé“¾è·¯å‘ udevd å‘é€é€šçŸ¥äº‹ä»¶ - <em>uevent</em></li><li>udevd è¯»å– uevent ä¸­çš„æ‰€æœ‰å‚æ•°</li><li>udevd è½¬æ¢è§„åˆ™ï¼Œå¹¶æ ¹æ®è§„åˆ™åšä¸€äº›åŠ¨ä½œæˆ–è®¾ç½®ä¸€äº›å‚æ•°</li></ol><h3 id="_3-5-3-udevadm" tabindex="-1"><a class="header-anchor" href="#_3-5-3-udevadm"><span>3.5.3 udevadm</span></a></h3><p>udevadm ç¨‹åºæ˜¯ä¸€ä¸ª udevd ç®¡ç†å·¥å…·ï¼š</p><ul><li>å¯¹ç³»ç»Ÿè®¾å¤‡è¿›è¡Œæœç´¢</li><li>ç›‘æ§å†…æ ¸å‘ udevd å‘é€çš„ uevents</li></ul><h3 id="_3-5-4-monitoring-devices" tabindex="-1"><a class="header-anchor" href="#_3-5-4-monitoring-devices"><span>3.5.4 Monitoring Devices</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">udevadm monitor</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><hr><h2 id="_3-6-in-depth-scsi-and-the-linux-kernel" tabindex="-1"><a class="header-anchor" href="#_3-6-in-depth-scsi-and-the-linux-kernel"><span>3.6 In-Depth SCSI and the Linux Kernel</span></a></h2><p>Small Computer System Interface - SCSIã€‚ä¼ ç»Ÿçš„ SCSI ç¡¬ä»¶ç”±ä¸€ä¸ª host adapter è¿æ¥ SCSI æ€»çº¿ä¸Šçš„ä¸€ä¸²è®¾å¤‡æ„æˆçš„ï¼ŒHost Adapter å†è¿æ¥åˆ°ç”µè„‘ã€‚</p><p><img src="`+d+`" alt="scsi"></p><p>Host Adapter å’Œæ¯ä¸ªè®¾å¤‡éƒ½æœ‰ SCSI IDã€‚æ ¹æ® SCSI ç‰ˆæœ¬ï¼Œå†³å®šæ¯ä¸ªæ€»çº¿ä¸Šå¯ä»¥æœ‰ 8 æˆ– 16 ä¸ª IDã€‚Host Adapter é€šè¿‡ SCSI å‘½ä»¤ä¸è®¾å¤‡é€šä¿¡ã€‚ç”µè„‘ä¸ç›´æ¥æ“ä½œè®¾å¤‡ï¼Œè€Œæ˜¯é€šè¿‡ adapter è½¬æ¥ã€‚è¿è¡Œå‘½ä»¤ï¼š</p><div class="language-console line-numbers-mode" data-highlighter="prismjs" data-ext="console" data-title="console"><pre><code><span class="line">$ lsscsi</span>
<span class="line">[0:0:0:0]  disk    ATA    WDC  WD3200AAJS-2  01.0  /dev/sda</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¼–å·å«ä¹‰ï¼ˆä»å·¦åˆ°å³ï¼‰ï¼š</p><ul><li>SCSI host adapter number</li><li>SCSI bus number</li><li>Device SCSI ID</li><li>Logical Unit Number</li></ul><p>SCSI å­ç³»ç»ŸåŠå…¶ä¸‰å±‚é©±åŠ¨ï¼š</p><p><img src="`+l+'" alt="scsi-subsystem"></p><ul><li>æœ€é¡¶å±‚å¤„ç†ä¸€ç±»è®¾å¤‡çš„æ“ä½œ <ul><li>æ¯”å¦‚å°†å†…æ ¸ä¸­çš„ block device è¯·æ±‚è½¬æ¢ä¸º SCSI åè®®ä¸­å¯¹åº”çš„å‘½ä»¤ï¼Œåä¹‹äº¦ç„¶</li></ul></li><li>ä¸­é—´å±‚è½¬å‘ä¸Šå±‚å’Œä¸‹å±‚ä¹‹é—´çš„ SCSI æ¶ˆæ¯ï¼Œå¹¶è¿½è¸ªç³»ç»Ÿè¿æ¥çš„æ‰€æœ‰ SCSI æ€»çº¿å’Œè®¾å¤‡</li><li>æœ€ä¸‹å±‚å¤„ç†ç¡¬ä»¶ç›¸å…³çš„æ“ä½œ <ul><li>å°† SCSI æ¶ˆæ¯å‘é€åˆ°ç‰¹å®šçš„ host adapters ä¸Šï¼Œåä¹‹äº¦ç„¶</li><li>åŒä¸€ç±»è®¾å¤‡çš„ SCSI message æ˜¯ç»Ÿä¸€çš„ï¼Œä¸åŒçš„ host adapter å¯¹å‘é€ç›¸åŒçš„ message æœ‰ç€ä¸åŒçš„æ­¥éª¤</li></ul></li></ul><h3 id="_3-6-1-usb-storage-and-scsi" tabindex="-1"><a class="header-anchor" href="#_3-6-1-usb-storage-and-scsi"><span>3.6.1 USB Storage and SCSI</span></a></h3><h3 id="_3-6-2-scsi-and-ata" tabindex="-1"><a class="header-anchor" href="#_3-6-2-scsi-and-ata"><span>3.6.2 SCSI and ATA</span></a></h3><h3 id="_3-6-3-generic-scsi-devices" tabindex="-1"><a class="header-anchor" href="#_3-6-3-generic-scsi-devices"><span>3.6.3 Generic SCSI Devices</span></a></h3><p>ç”¨æˆ·ç©ºé—´é€šè¿‡ block device interface æ“ä½œ SCSI å­ç³»ç»Ÿï¼Œå› æ­¤ä¸éœ€è¦çŸ¥é“ SCSI åè®®çš„ç»†èŠ‚ã€‚ä½†ç”¨æˆ·å¯ä»¥é€šè¿‡ <em>generic devices</em> ç»•è¿‡ block device interfaceï¼Œç›´æ¥å‘è®¾å¤‡å‘é€ SCSI å‘½ä»¤ã€‚</p><p><img src="'+r+'" alt="generic-driver"></p><hr>',77)]))}const v=s(c,[["render",o],["__file","Chapter 3 - Devices.html.vue"]]),u=JSON.parse('{"path":"/how-linux-works-notes/Chapter%203%20-%20Devices.html","title":"Chapter 3 - Devices","lang":"en-US","frontmatter":{},"headers":[{"level":2,"title":"3.1 Device Files","slug":"_3-1-device-files","link":"#_3-1-device-files","children":[{"level":3,"title":"Block Device","slug":"block-device","link":"#block-device","children":[]},{"level":3,"title":"Character Device","slug":"character-device","link":"#character-device","children":[]},{"level":3,"title":"Pipe Device","slug":"pipe-device","link":"#pipe-device","children":[]},{"level":3,"title":"Socket Device","slug":"socket-device","link":"#socket-device","children":[]}]},{"level":2,"title":"3.2 The sysfs Device Path","slug":"_3-2-the-sysfs-device-path","link":"#_3-2-the-sysfs-device-path","children":[]},{"level":2,"title":"3.3 dd and Devices","slug":"_3-3-dd-and-devices","link":"#_3-3-dd-and-devices","children":[]},{"level":2,"title":"3.4 Devices Name Summary","slug":"_3-4-devices-name-summary","link":"#_3-4-devices-name-summary","children":[{"level":3,"title":"3.4.1 Hard Disks: /dev/sd*","slug":"_3-4-1-hard-disks-dev-sd","link":"#_3-4-1-hard-disks-dev-sd","children":[]},{"level":3,"title":"3.4.2 CD and DVD Drivers: /dev/sr*","slug":"_3-4-2-cd-and-dvd-drivers-dev-sr","link":"#_3-4-2-cd-and-dvd-drivers-dev-sr","children":[]},{"level":3,"title":"3.4.3 PATA Hard Disks: /dev/hd*","slug":"_3-4-3-pata-hard-disks-dev-hd","link":"#_3-4-3-pata-hard-disks-dev-hd","children":[]},{"level":3,"title":"3.4.4 Terminals: /dev/tty*, /dev/pts/*, and /dev/tty","slug":"_3-4-4-terminals-dev-tty-dev-pts-and-dev-tty","link":"#_3-4-4-terminals-dev-tty-dev-pts-and-dev-tty","children":[]},{"level":3,"title":"3.4.5 Serial Ports: /dev/ttyS*","slug":"_3-4-5-serial-ports-dev-ttys","link":"#_3-4-5-serial-ports-dev-ttys","children":[]},{"level":3,"title":"3.4.6 Parallel Ports: /dev/lp0 and /dev/lp1","slug":"_3-4-6-parallel-ports-dev-lp0-and-dev-lp1","link":"#_3-4-6-parallel-ports-dev-lp0-and-dev-lp1","children":[]},{"level":3,"title":"3.4.7 Audio Devices: /dev/snd/*, /dev/dsp, /dev/audio, and More","slug":"_3-4-7-audio-devices-dev-snd-dev-dsp-dev-audio-and-more","link":"#_3-4-7-audio-devices-dev-snd-dev-dsp-dev-audio-and-more","children":[]}]},{"level":2,"title":"3.5 udev","slug":"_3-5-udev","link":"#_3-5-udev","children":[{"level":3,"title":"3.5.1 devtmpfs","slug":"_3-5-1-devtmpfs","link":"#_3-5-1-devtmpfs","children":[]},{"level":3,"title":"3.5.2 udevd Operation and Configuration","slug":"_3-5-2-udevd-operation-and-configuration","link":"#_3-5-2-udevd-operation-and-configuration","children":[]},{"level":3,"title":"3.5.3 udevadm","slug":"_3-5-3-udevadm","link":"#_3-5-3-udevadm","children":[]},{"level":3,"title":"3.5.4 Monitoring Devices","slug":"_3-5-4-monitoring-devices","link":"#_3-5-4-monitoring-devices","children":[]}]},{"level":2,"title":"3.6 In-Depth SCSI and the Linux Kernel","slug":"_3-6-in-depth-scsi-and-the-linux-kernel","link":"#_3-6-in-depth-scsi-and-the-linux-kernel","children":[{"level":3,"title":"3.6.1 USB Storage and SCSI","slug":"_3-6-1-usb-storage-and-scsi","link":"#_3-6-1-usb-storage-and-scsi","children":[]},{"level":3,"title":"3.6.2 SCSI and ATA","slug":"_3-6-2-scsi-and-ata","link":"#_3-6-2-scsi-and-ata","children":[]},{"level":3,"title":"3.6.3 Generic SCSI Devices","slug":"_3-6-3-generic-scsi-devices","link":"#_3-6-3-generic-scsi-devices","children":[]}]}],"git":{},"filePathRelative":"how-linux-works-notes/Chapter 3 - Devices.md"}');export{v as comp,u as data};
