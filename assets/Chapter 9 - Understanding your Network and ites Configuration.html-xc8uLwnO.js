import{_ as e,c as s,a,o as i}from"./app-BeHGwf2X.js";const l={};function t(r,n){return i(),s("div",null,n[0]||(n[0]=[a(`<h1 id="chapter-9-understanding-your-network-and-its-configuration" tabindex="-1"><a class="header-anchor" href="#chapter-9-understanding-your-network-and-its-configuration"><span>Chapter 9 - Understanding your Network and its Configuration</span></a></h1><p>Created by : Mr Dk.</p><p>2019 / 07 / 07 20:50</p><p>@NUAA, Nanjing, Jiangsu, China</p><hr><p>è¿™ç« é‡Œçš„å¤§éƒ¨åˆ†çŸ¥è¯†ä»¥å‰ä¸Šè¯¾éƒ½å­¦è¿‡äº†</p><p>è®°å‡ ä¸ªå¸¸ç”¨å‘½ä»¤æ‹‰å€’äº† ğŸ˜‘</p><hr><h2 id="_9-4-routes-and-the-kernel-routing-table" tabindex="-1"><a class="header-anchor" href="#_9-4-routes-and-the-kernel-routing-table"><span>9.4 Routes and the Kernel Routing Table</span></a></h2><p>å†…æ ¸é€šè¿‡è·¯ç”±è¡¨å†³å®šå°† packet è·¯ç”±åˆ°ä½•å¤„ï¼š</p><div class="language-console line-numbers-mode" data-highlighter="prismjs" data-ext="console" data-title="console"><pre><code><span class="line">$ route -n</span>
<span class="line">å†…æ ¸ IP è·¯ç”±è¡¨</span>
<span class="line">ç›®æ ‡            ç½‘å…³            å­ç½‘æ©ç         æ ‡å¿—  è·ƒç‚¹   å¼•ç”¨  ä½¿ç”¨ æ¥å£</span>
<span class="line">0.0.0.0         192.168.2.100   0.0.0.0         UG    100    0        0 enp4s0</span>
<span class="line">169.254.0.0     0.0.0.0         255.255.0.0     U     1000   0        0 enp4s0</span>
<span class="line">192.168.2.0     0.0.0.0         255.255.255.0   U     100    0        0 enp4s0</span>
<span class="line">$ route</span>
<span class="line">å†…æ ¸ IP è·¯ç”±è¡¨</span>
<span class="line">ç›®æ ‡            ç½‘å…³            å­ç½‘æ©ç         æ ‡å¿—  è·ƒç‚¹   å¼•ç”¨  ä½¿ç”¨ æ¥å£</span>
<span class="line">default         _gateway        0.0.0.0         UG    100    0        0 enp4s0</span>
<span class="line">link-local      0.0.0.0         255.255.0.0     U     1000   0        0 enp4s0</span>
<span class="line">192.168.2.0     0.0.0.0         255.255.255.0   U     100    0        0 enp4s0</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ç›®æ ‡ + å­ç½‘æ©ç ä¸¤åˆ—å†³å®šäº†å¯¹åº”ç›®æ ‡ç½‘ç»œ</li><li>æ ‡è¯†ä½ä¸­ï¼Œ<code>U</code> è¡¨ç¤º <em>Up</em>ï¼Œå³æœ‰æ•ˆ</li><li>æ ‡è¯†ä½ä¸­ï¼Œ<code>G</code> è¡¨ç¤º <em>Gateway</em>ï¼Œå³æ‰€æœ‰ç¬¦åˆè¯¥è·¯ç”±è®°å½•çš„ packet éƒ½ä¼šè¢«é€åˆ°ç½‘å…³</li></ul><p>å¦‚æœåŒæ—¶æ»¡è¶³è·¯ç”±è¡¨ä¸­çš„å¤šæ¡è®°å½•ï¼Œæ ¹æ® CIDRï¼ŒåŒ¹é…ç½‘ç»œå‰ç¼€ç›¸åŒæœ€é•¿çš„é‚£ä¸€ä¸ªã€‚</p><h2 id="_9-8-introduction-to-network-interface-configuration" tabindex="-1"><a class="header-anchor" href="#_9-8-introduction-to-network-interface-configuration"><span>9.8 Introduction to Network Interface Configuration</span></a></h2><h3 id="_9-8-1-manually-adding-and-deleting-routes" tabindex="-1"><a class="header-anchor" href="#_9-8-1-manually-adding-and-deleting-routes"><span>9.8.1 Manually Adding and Deleting Routes</span></a></h3><p>é€šè¿‡ <code>route</code> å‘½ä»¤èƒ½å¤Ÿæ‰‹åŠ¨å¢åŠ æˆ–åˆ é™¤è·¯ç”±ã€‚</p><h2 id="_9-12-resolving-hostnames" tabindex="-1"><a class="header-anchor" href="#_9-12-resolving-hostnames"><span>9.12 Resolving Hostnames</span></a></h2><p>DNS è§£æè¿‡ç¨‹ï¼š</p><ol><li>åº”ç”¨ç¨‹åºè°ƒç”¨å‡½æ•°ï¼ŒæŸ¥æ‰¾ IP åœ°å€ä¸‹çš„åŸŸåï¼Œå‡½æ•°ä½äºç³»ç»Ÿçš„ shared library</li><li>Shared library ä¸­çš„å‡½æ•°æ ¹æ® <code>/etc/nsswitch.conf</code> ä¸­çš„è§„åˆ™å†³å®šæŸ¥æ‰¾çš„è¡Œä¸ºï¼Œæ¯”å¦‚åœ¨æŸ¥æ‰¾ DNS ä¹‹å‰ï¼Œæ£€æŸ¥ <code>/etc/hosts</code> ä¸­çš„æ‰‹åŠ¨è¦†ç›–</li><li>å½“å‡½æ•°å†³å®šæŸ¥æ‰¾ DNS æ—¶ï¼ŒæŸ¥æ‰¾é¢å¤–çš„é…ç½®æ–‡ä»¶ <code>/etc/resolv.conf</code>ï¼Œå–å¾— DNS åŸŸåæœåŠ¡å™¨çš„ IP åœ°å€</li><li>å‡½æ•°å‘åŸŸåæœåŠ¡å™¨å‘é€ DNS æŸ¥æ‰¾è¯·æ±‚</li><li>åŸŸåæœåŠ¡å™¨è¿”å›å¯¹åº”åŸŸåçš„ IP åœ°å€ï¼Œå‡½æ•°å°† IP åœ°å€è¿”å›ç»™åº”ç”¨</li></ol><h2 id="_9-14-the-transport-layer-tcp-udp-and-services" tabindex="-1"><a class="header-anchor" href="#_9-14-the-transport-layer-tcp-udp-and-services"><span>9.14 The Transport Layer: TCP, UDP, and Services</span></a></h2><h3 id="_9-14-1-tcp-ports-and-connections" tabindex="-1"><a class="header-anchor" href="#_9-14-1-tcp-ports-and-connections"><span>9.14.1 TCP Ports and Connections</span></a></h3><p>æŸ¥çœ‹æœ¬æœºç›®å‰å·²ç»å»ºç«‹çš„è¿æ¥ï¼š</p><div class="language-console line-numbers-mode" data-highlighter="prismjs" data-ext="console" data-title="console"><pre><code><span class="line">$ netstat -nt</span>
<span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State</span>
<span class="line">tcp        0    192 192.168.2.104:22        192.168.2.102:50660     ESTABLISHED</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>-n</code> è¡¨ç¤ºå–æ¶ˆåŸŸåæ˜¾ç¤º</li><li><code>-t</code> è¡¨ç¤ºåªæ˜¾ç¤º TCP è¿æ¥</li></ul><h3 id="_9-14-2-establishing-tcp-connections" tabindex="-1"><a class="header-anchor" href="#_9-14-2-establishing-tcp-connections"><span>9.14.2 Establishing TCP Connections</span></a></h3><p>ä¸ºäº†å»ºç«‹è¿æ¥ï¼Œå¿…é¡»æœ‰ä¸€ä¸ªè¿›ç¨‹æ­£åœ¨ç›‘å¬æŸä¸ªç«¯å£ã€‚é€šå¸¸æ¥è¯´ï¼Œç›‘å¬çš„ç«¯å£éƒ½æ˜¯æä¾›ç†ŸçŸ¥æœåŠ¡çš„ï¼Œè€Œå‘èµ·è¿æ¥çš„ç«¯å£æ˜¯åŠ¨æ€åˆ†é…çš„ã€‚æŸ¥çœ‹æ‰€æœ‰æ­£è¢«ç›‘å¬çš„ TCP ç«¯å£ï¼š</p><div class="language-console line-numbers-mode" data-highlighter="prismjs" data-ext="console" data-title="console"><pre><code><span class="line">$ netstat -ntl</span>
<span class="line">æ¿€æ´»Internetè¿æ¥ (ä»…æœåŠ¡å™¨)</span>
<span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State</span>
<span class="line">tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN</span>
<span class="line">tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN</span>
<span class="line">tcp        0      0 127.0.0.1:631           0.0.0.0:*               LISTEN</span>
<span class="line">tcp6       0      0 :::22                   :::*                    LISTEN</span>
<span class="line">tcp6       0      0 ::1:631                 :::*                    LISTEN</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_9-14-3-port-numbers-and-etc-services" tabindex="-1"><a class="header-anchor" href="#_9-14-3-port-numbers-and-etc-services"><span>9.14.3 Port Numbers and /etc/services</span></a></h3><p>åœ¨ <code>/etc/services</code> ä¸­å¯ä»¥æŸ¥åˆ°ç†ŸçŸ¥ç«¯å£å·å’Œå¯¹åº”çš„æœåŠ¡ï¼š</p><div class="language-console line-numbers-mode" data-highlighter="prismjs" data-ext="console" data-title="console"><pre><code><span class="line">$ cat /etc/services</span>
<span class="line"># Network services, Internet style</span>
<span class="line">#</span>
<span class="line"># Note that it is presently the policy of IANA to assign a single well-known</span>
<span class="line"># port number for both TCP and UDP; hence, officially ports have two entries</span>
<span class="line"># even if the protocol doesn&#39;t support UDP operations.</span>
<span class="line">#</span>
<span class="line"># Updated from http://www.iana.org/assignments/port-numbers and other</span>
<span class="line"># sources like http://www.freebsd.org/cgi/cvsweb.cgi/src/etc/services .</span>
<span class="line"># New ports will be added on request if they have been officially assigned</span>
<span class="line"># by IANA and used in the real-world or are needed by a debian package.</span>
<span class="line"># If you need a huge list of used numbers please install the nmap package.</span>
<span class="line"></span>
<span class="line">tcpmux          1/tcp                           # TCP port service multiplexer</span>
<span class="line">echo            7/tcp</span>
<span class="line">echo            7/udp</span>
<span class="line">discard         9/tcp           sink null</span>
<span class="line">discard         9/udp           sink null</span>
<span class="line">systat          11/tcp          users</span>
<span class="line">daytime         13/tcp</span>
<span class="line">daytime         13/udp</span>
<span class="line">netstat         15/tcp</span>
<span class="line">qotd            17/tcp          quote</span>
<span class="line">msp             18/tcp                          # message send protocol</span>
<span class="line">msp             18/udp</span>
<span class="line">chargen         19/tcp          ttytst source</span>
<span class="line">chargen         19/udp          ttytst source</span>
<span class="line">ftp-data        20/tcp</span>
<span class="line">ftp             21/tcp</span>
<span class="line">fsp             21/udp          fspd</span>
<span class="line">ssh             22/tcp                          # SSH Remote Login Protocol</span>
<span class="line">telnet          23/tcp</span>
<span class="line">smtp            25/tcp          mail</span>
<span class="line">time            37/tcp          timserver</span>
<span class="line">time            37/udp          timserver</span>
<span class="line">rlp             39/udp          resource        # resource location</span>
<span class="line">nameserver      42/tcp          name            # IEN 116</span>
<span class="line">whois           43/tcp          nicname</span>
<span class="line">tacacs          49/tcp                          # Login Host Protocol (TACACS)</span>
<span class="line">tacacs          49/udp</span>
<span class="line">re-mail-ck      50/tcp                          # Remote Mail Checking Protocol</span>
<span class="line">re-mail-ck      50/udp</span>
<span class="line">domain          53/tcp                          # Domain Name Server</span>
<span class="line">domain          53/udp</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_9-17-configuring-linux-as-a-router" tabindex="-1"><a class="header-anchor" href="#_9-17-configuring-linux-as-a-router"><span>9.17 Configuring Linux as a Router</span></a></h2><p>Linux å†…æ ¸é»˜è®¤ä¸ä¼šè‡ªåŠ¨å°† packet ä»ä¸€ä¸ªå­ç½‘ä¼ è¾“åˆ°å¦ä¸€ä¸ªå­ç½‘ï¼Œéœ€è¦æ‰‹åŠ¨å¼€å¯ IP è½¬å‘ï¼š</p><div class="language-console line-numbers-mode" data-highlighter="prismjs" data-ext="console" data-title="console"><pre><code><span class="line">$ sudo sysctl -w net.ipv4.ip_forward</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="_9-21-firewalls" tabindex="-1"><a class="header-anchor" href="#_9-21-firewalls"><span>9.21 Firewalls</span></a></h2><p>é˜²ç«å¢™ä¸Šä½äºè·¯ç”±å™¨ä¸Šï¼Œä½äº Internet å’Œå†…éƒ¨ç½‘ç»œä¹‹é—´ï¼Œåˆæ˜¯ä¹Ÿè¢«ç§°ä¸º IP è¿‡æ»¤å™¨ã€‚ç³»ç»Ÿå¯ä»¥åœ¨ä»¥ä¸‹æƒ…å†µä¸­è¿‡æ»¤ IPï¼š</p><ul><li>æ”¶åˆ°ä¸€ä¸ª packet</li><li>å‘é€ä¸€ä¸ª packet</li><li>è½¬å‘ packet åˆ°å¦ä¸€ä¸ª host æˆ–ç½‘å…³</li></ul><p>é˜²ç«å¢™åœ¨ä»¥ä¸Šä¸‰ç§æƒ…å†µä¹‹å‰å¸ƒè®¾äº†æ£€æŸ¥ç‚¹ï¼Œç”¨äºï¼š</p><ul><li>drop</li><li>reject</li><li>accept</li></ul><h3 id="_9-21-1-linux-firewall-basics" tabindex="-1"><a class="header-anchor" href="#_9-21-1-linux-firewall-basics"><span>9.21.1 Linux Firewall Basics</span></a></h3><p>åœ¨ Linux ä¸­ï¼Œä¸€ç³»åˆ—é˜²ç«å¢™è§„åˆ™è¢«ç§°ä¸º <em>chain</em>ã€‚chain çš„é›†åˆç»„æˆäº† <em>table</em>ã€‚å†…æ ¸ä½¿ç”¨ç‰¹å®šçš„ chain å¯¹ packet è¿›è¡Œæ£€æŸ¥ï¼Œæ‰€æœ‰çš„ç›¸å…³æ•°æ®ç»“æ„éƒ½ç”±å†…æ ¸ç»´æŠ¤ï¼Œæ•´ä¸ªç³»ç»Ÿè¢«ç§°ä¸º <em>iptables</em>ã€‚</p><p>ç”¨æˆ·ç©ºé—´å‘½ä»¤ <code>iptables</code> åˆ›å»ºæˆ–ä¿®æ”¹è§„åˆ™ã€‚å¯èƒ½ä¼šæœ‰å¾ˆå¤šä¸ª tableï¼Œä½†å¹³å¸¸çš„å·¥ä½œéƒ½å¯ä»¥åœ¨ filter table ä¸­å®Œæˆã€‚filter table ä¸­æœ‰ä¸‰ä¸ªåŸºæœ¬çš„ chainï¼š</p><ul><li>INPUT</li><li>OUTPUT</li><li>FORWARD</li></ul><h3 id="_9-21-2-setting-firewall-rules" tabindex="-1"><a class="header-anchor" href="#_9-21-2-setting-firewall-rules"><span>9.21.2 Setting Firewall Rules</span></a></h3><p>ä¸€å¤§å †æœ‰å…³ <code>iptables</code> çš„å‘½ä»¤ï¼Œä¸æƒ³çœ‹äº†ï¼Œçƒ¦ ğŸ˜ª</p>`,44)]))}const d=e(l,[["render",t],["__file","Chapter 9 - Understanding your Network and ites Configuration.html.vue"]]),p=JSON.parse('{"path":"/how-linux-works-notes/Chapter%209%20-%20Understanding%20your%20Network%20and%20ites%20Configuration.html","title":"Chapter 9 - Understanding your Network and its Configuration","lang":"en-US","frontmatter":{},"headers":[{"level":2,"title":"9.4 Routes and the Kernel Routing Table","slug":"_9-4-routes-and-the-kernel-routing-table","link":"#_9-4-routes-and-the-kernel-routing-table","children":[]},{"level":2,"title":"9.8 Introduction to Network Interface Configuration","slug":"_9-8-introduction-to-network-interface-configuration","link":"#_9-8-introduction-to-network-interface-configuration","children":[{"level":3,"title":"9.8.1 Manually Adding and Deleting Routes","slug":"_9-8-1-manually-adding-and-deleting-routes","link":"#_9-8-1-manually-adding-and-deleting-routes","children":[]}]},{"level":2,"title":"9.12 Resolving Hostnames","slug":"_9-12-resolving-hostnames","link":"#_9-12-resolving-hostnames","children":[]},{"level":2,"title":"9.14 The Transport Layer: TCP, UDP, and Services","slug":"_9-14-the-transport-layer-tcp-udp-and-services","link":"#_9-14-the-transport-layer-tcp-udp-and-services","children":[{"level":3,"title":"9.14.1 TCP Ports and Connections","slug":"_9-14-1-tcp-ports-and-connections","link":"#_9-14-1-tcp-ports-and-connections","children":[]},{"level":3,"title":"9.14.2 Establishing TCP Connections","slug":"_9-14-2-establishing-tcp-connections","link":"#_9-14-2-establishing-tcp-connections","children":[]},{"level":3,"title":"9.14.3 Port Numbers and /etc/services","slug":"_9-14-3-port-numbers-and-etc-services","link":"#_9-14-3-port-numbers-and-etc-services","children":[]}]},{"level":2,"title":"9.17 Configuring Linux as a Router","slug":"_9-17-configuring-linux-as-a-router","link":"#_9-17-configuring-linux-as-a-router","children":[]},{"level":2,"title":"9.21 Firewalls","slug":"_9-21-firewalls","link":"#_9-21-firewalls","children":[{"level":3,"title":"9.21.1 Linux Firewall Basics","slug":"_9-21-1-linux-firewall-basics","link":"#_9-21-1-linux-firewall-basics","children":[]},{"level":3,"title":"9.21.2 Setting Firewall Rules","slug":"_9-21-2-setting-firewall-rules","link":"#_9-21-2-setting-firewall-rules","children":[]}]}],"git":{},"filePathRelative":"how-linux-works-notes/Chapter 9 - Understanding your Network and ites Configuration.md"}');export{d as comp,p as data};
