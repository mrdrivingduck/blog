import{_ as n,c as s,a,o as l}from"./app-BeHGwf2X.js";const i="/blog/assets/wep-encryption-CY5wlW90.png",r="/blog/assets/wep-decryption-DcFbrTay.png",c="/blog/assets/wep-crk-router-Cl-zwoJz.png",t="/blog/assets/wep-crk-init-DSe1mq8f.png",o="/blog/assets/wep-crk-mon-BDGMV7M4.png",p="/blog/assets/wep-crk-ifconfig-IJaU3vow.png",d="/blog/assets/wep-crk-target-Cda7XVCF.png",h="/blog/assets/wep-crk-pkg-DnlIwykJ.png",g="/blog/assets/wep-crk-result-ZGrH6Fdu.png",m={};function u(b,e){return l(),s("div",null,e[0]||(e[0]=[a('<h1 id="wireless-wep-cracking-by-aircrack-ng" tabindex="-1"><a class="header-anchor" href="#wireless-wep-cracking-by-aircrack-ng"><span>Wireless - WEP Cracking by Aircrack-ng</span></a></h1><p>Created by : Mr Dk.</p><p>2018 / 12 / 04 16:48</p><p>Nanjing, Jiangsu, China</p><hr><h2 id="concept" tabindex="-1"><a class="header-anchor" href="#concept"><span>Concept</span></a></h2><p>有线等效加密 (<em>Wired Equivalent Privacy, WEP</em>) 又称无线加密协议 (<em>Wireless Encryption Protocol, WEP</em>) 是用于保护无线网络信息安全的一种体制，是 IEEE 802.11 标准的一部分：</p><ul><li>使用 <em>RC4</em> 加密技术保证 <strong>机密性</strong></li><li>使用 <em>CRC-32</em> 校验技术保证 <strong>完整性</strong></li></ul><h2 id="theory" tabindex="-1"><a class="header-anchor" href="#theory"><span>Theory</span></a></h2><h3 id="encryption" tabindex="-1"><a class="header-anchor" href="#encryption"><span>Encryption</span></a></h3><p>使用一个 24-bit 的初始化向量 IV</p><ul><li>将 IV 与密码一起作为 RC4 的密钥</li><li>将数据与其 CRC-32 校验作为明文</li><li>将明文用密钥加密得到密文</li><li>将 IV 与密文一起发送</li></ul><p><img src="'+i+'" alt="wep-encryption"></p><h3 id="decryption" tabindex="-1"><a class="header-anchor" href="#decryption"><span>Decryption</span></a></h3><p>得到 IV 与密文</p><ul><li>将提取出的 IV 与密码一起作为 RC4 的密钥</li><li>用密钥将密文解密为明文</li><li>从明文中提取出数据和 CRC-32 校验</li></ul><p>将数据进行 CRC-32 校验，并与提取出的校验和进行比较。如果校验和相同，则接收端接收到了原始数据。</p><p><img src="'+r+'" alt="wep-decryption"></p><h2 id="tools" tabindex="-1"><a class="header-anchor" href="#tools"><span>Tools</span></a></h2><p><em>Aircrack-ng</em> on <em>Kali Linux x64</em>。Aircrack-ng 是一个分析 IEEE 802.11 标准网络的安全软件，主要功能包括：</p><ul><li>网络侦测</li><li>数据包嗅探</li><li>WEP、WPA、WPA2 破解</li></ul><h2 id="procedure" tabindex="-1"><a class="header-anchor" href="#procedure"><span>Procedure</span></a></h2><h3 id="将路由器配置为-wep-加密模式" tabindex="-1"><a class="header-anchor" href="#将路由器配置为-wep-加密模式"><span>将路由器配置为 WEP 加密模式</span></a></h3><p><img src="'+c+`" alt="wep-crk-router"></p><p>为了简单起见，将密钥设置为 <code>12345</code>。</p><h3 id="插入无线网卡并查看是否被-os-识别" tabindex="-1"><a class="header-anchor" href="#插入无线网卡并查看是否被-os-识别"><span>插入无线网卡并查看是否被 OS 识别</span></a></h3><div class="language-console line-numbers-mode" data-highlighter="prismjs" data-ext="console" data-title="console"><pre><code><span class="line">$ ifconfig</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+t+`" alt="wep-crk-init"></p><p>可以看到插入的 USB 网卡已被识别，并被命名为 <code>wlan0</code>。</p><h3 id="将网卡设置为监控模式" tabindex="-1"><a class="header-anchor" href="#将网卡设置为监控模式"><span>将网卡设置为监控模式</span></a></h3><div class="language-console line-numbers-mode" data-highlighter="prismjs" data-ext="console" data-title="console"><pre><code><span class="line">$ airmon-ng start wlan0</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+o+`" alt="wep-crk-mon"></p><h3 id="查看网卡是否已进入监控模式" tabindex="-1"><a class="header-anchor" href="#查看网卡是否已进入监控模式"><span>查看网卡是否已进入监控模式</span></a></h3><div class="language-console line-numbers-mode" data-highlighter="prismjs" data-ext="console" data-title="console"><pre><code><span class="line">$ ifconfig</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+p+`" alt="wep-crk-ifconfig"></p><p>可以看到 <code>wlan0</code> 网卡进入监控模式后被命名为 <code>wlan0mon</code>。</p><h3 id="使用网卡监控空间内的无线网络通信状态" tabindex="-1"><a class="header-anchor" href="#使用网卡监控空间内的无线网络通信状态"><span>使用网卡监控空间内的无线网络通信状态</span></a></h3><div class="language-console line-numbers-mode" data-highlighter="prismjs" data-ext="console" data-title="console"><pre><code><span class="line">$ airodump-ng wlan0mon</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+d+`" alt="wep-crk-target"></p><p>从所有的设备中选择要破解的目标。</p><h3 id="抓取攻击目标的数据包" tabindex="-1"><a class="header-anchor" href="#抓取攻击目标的数据包"><span>抓取攻击目标的数据包</span></a></h3><div class="language-console line-numbers-mode" data-highlighter="prismjs" data-ext="console" data-title="console"><pre><code><span class="line">$ airodump-ng -w test -c 11 --bssid 00:6B:8E:5E:7E:E8 wlan0mon</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>参数信息：</p><ul><li><code>-w</code> 表示数据包写入的文件路径</li><li><code>-c</code> 表示监听的信道 (channel)</li><li><code>--bssid</code> 表示监听设备的 MAC 地址</li><li>最后一个参数为网卡名</li></ul><p><img src="`+h+`" alt="wep-crk-pkg"></p><p>可以看到选定的目标 AP：<code>Mr.Drivingduck</code> 的加密方式为 WEP，有两个客户端连接到了该 AP 上 - 分别是我的 <code>iPhone X</code> &amp; <code>Surface Pro</code>。</p><h3 id="获取大量数据包" tabindex="-1"><a class="header-anchor" href="#获取大量数据包"><span>获取大量数据包</span></a></h3><p>获取的数据包越多，获取到的 IV 值就越多，破解的概率就越大。可以对连接到该 AP 的客户端使用 <strong>洪泛解除认证攻击</strong>，迫使客户端发送重新连接的数据包，从而获得更多数据包。</p><div class="language-console line-numbers-mode" data-highlighter="prismjs" data-ext="console" data-title="console"><pre><code><span class="line">$ aireplay-ng -0 10 -a 00:6B:8E:5E:7E:E8 -c B8:C1:11:02:B7:05 wlan0mon</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>参数信息：</p><ul><li><code>-0</code> 表示洪泛攻击，之后表示洪泛攻击的次数</li><li><code>-a</code> 表示被攻击 AP 的 MAC 地址</li><li><code>-c</code> 表示被攻击客户端设备的 MAC 地址</li><li>最后一个参数为网卡名</li></ul><p>为了方便，我没有使用洪泛攻击的方式获取大量数据包。我使用的方法是，用 <code>Surface Pro</code> 开启百度云盘下载一个很大的文件，从而发出大量数据包。</p><h3 id="利用抓取到的数据包进行破解" tabindex="-1"><a class="header-anchor" href="#利用抓取到的数据包进行破解"><span>利用抓取到的数据包进行破解</span></a></h3><div class="language-console line-numbers-mode" data-highlighter="prismjs" data-ext="console" data-title="console"><pre><code><span class="line">$ aircrack-ng -a 1 test-01.cap</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>参数信息：</p><ul><li><code>-a</code> 表示破解模式，<code>1</code> 表示 WEP 破解</li><li>最后的参数为抓取到的数据包文件</li></ul><p><img src="`+g+'" alt="wep-crk-result"></p><p>总共利用了 27563 个数据包，破解出了 5 位的 WEP 密钥。如果使用 13 位密钥，可能需要抓取更多数据包。</p><h2 id="summary" tabindex="-1"><a class="header-anchor" href="#summary"><span>Summary</span></a></h2><p>亲身体验了一次当黑客的感觉。WEP 确实是一个很弱的加密方式，在嗅探到的所有设备里，除了我自己人为设定为 WEP 加密的 AP，其余设备都使用 WPA2 加密。但是这款软件可以将网卡设置为监控模式，还可以发起解除认证洪泛攻击，我认为可以用来测试 <em>kismet</em> 的攻击报警模块，待实验验证。</p>',60)]))}const k=n(m,[["render",u],["__file","Wireless WEP Cracking by Aircrack-ng.html.vue"]]),y=JSON.parse('{"path":"/notes/Wireless/Wireless%20WEP%20Cracking%20by%20Aircrack-ng.html","title":"Wireless - WEP Cracking by Aircrack-ng","lang":"en-US","frontmatter":{},"headers":[{"level":2,"title":"Concept","slug":"concept","link":"#concept","children":[]},{"level":2,"title":"Theory","slug":"theory","link":"#theory","children":[{"level":3,"title":"Encryption","slug":"encryption","link":"#encryption","children":[]},{"level":3,"title":"Decryption","slug":"decryption","link":"#decryption","children":[]}]},{"level":2,"title":"Tools","slug":"tools","link":"#tools","children":[]},{"level":2,"title":"Procedure","slug":"procedure","link":"#procedure","children":[{"level":3,"title":"将路由器配置为 WEP 加密模式","slug":"将路由器配置为-wep-加密模式","link":"#将路由器配置为-wep-加密模式","children":[]},{"level":3,"title":"插入无线网卡并查看是否被 OS 识别","slug":"插入无线网卡并查看是否被-os-识别","link":"#插入无线网卡并查看是否被-os-识别","children":[]},{"level":3,"title":"将网卡设置为监控模式","slug":"将网卡设置为监控模式","link":"#将网卡设置为监控模式","children":[]},{"level":3,"title":"查看网卡是否已进入监控模式","slug":"查看网卡是否已进入监控模式","link":"#查看网卡是否已进入监控模式","children":[]},{"level":3,"title":"使用网卡监控空间内的无线网络通信状态","slug":"使用网卡监控空间内的无线网络通信状态","link":"#使用网卡监控空间内的无线网络通信状态","children":[]},{"level":3,"title":"抓取攻击目标的数据包","slug":"抓取攻击目标的数据包","link":"#抓取攻击目标的数据包","children":[]},{"level":3,"title":"获取大量数据包","slug":"获取大量数据包","link":"#获取大量数据包","children":[]},{"level":3,"title":"利用抓取到的数据包进行破解","slug":"利用抓取到的数据包进行破解","link":"#利用抓取到的数据包进行破解","children":[]}]},{"level":2,"title":"Summary","slug":"summary","link":"#summary","children":[]}],"git":{},"filePathRelative":"notes/Wireless/Wireless WEP Cracking by Aircrack-ng.md"}');export{k as comp,y as data};
