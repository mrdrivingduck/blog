import{_ as r,c as a,a as n,o as s}from"./app-BeHGwf2X.js";const c={};function o(l,e){return s(),a("div",null,e[0]||(e[0]=[n(`<h1 id="linux-performance-perf-record" tabindex="-1"><a class="header-anchor" href="#linux-performance-perf-record"><span>Linux Performance - Perf Record</span></a></h1><p>Created by: Mr Dk.</p><p>2023 / 09 / 18 20:55 ğŸ’£</p><p>Hangzhou, Zhejiang, China</p><hr><h2 id="background" tabindex="-1"><a class="header-anchor" href="#background"><span>Background</span></a></h2><p><code>perf record</code> ç”¨äºé‡‡æ ·ç¨‹åºè¿è¡Œæ—¶çš„ç»Ÿè®¡ä¿¡æ¯å¹¶è®°å½•åˆ°æ–‡ä»¶ä¸­ã€‚é‡‡æ ·ç»“æœå¯ä»¥è¢«è½¬ç§»åˆ°å…¶å®ƒæœºå™¨ä¸Šè¿›è¡Œåˆ†æï¼Œéœ€è¦å’Œå…¶å®ƒ <code>perf</code> å­å‘½ä»¤é…åˆä½¿ç”¨ã€‚é‡‡æ ·çš„ç²’åº¦å¯ä»¥æ˜¯æ¯ä¸ªçº¿ç¨‹ã€æ¯ä¸ªè¿›ç¨‹ã€æ¯ä¸ª CPUã€æŸå‡ ç±»äº‹ä»¶ï¼Œç­‰ç­‰ã€‚</p><h2 id="usage" tabindex="-1"><a class="header-anchor" href="#usage"><span>Usage</span></a></h2><p>æ–‡æ¡£è¿‡é•¿ï¼Œé€‰é¡¹è¿‡å¤šï¼Œæš‚ä¸ä¸€ä¸€è®°å½•ã€‚æ ¹æ®æ€§èƒ½åˆ†æå¤§å¸ˆ Brendan Gregg æä¾›çš„ä¸€äº› <a href="https://www.brendangregg.com/perf.html" target="_blank" rel="noopener noreferrer">One-Liners</a>ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„å‘½ä»¤ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># Sample CPU stack traces (via frame pointers) for the specified PID, at 99 Hertz, for 10 seconds:</span></span>
<span class="line">perf record <span class="token parameter variable">-F</span> <span class="token number">99</span> <span class="token parameter variable">-p</span> PID <span class="token parameter variable">-g</span> -- <span class="token function">sleep</span> <span class="token number">10</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>å…¶ä¸­ï¼š</p><ul><li><code>-F</code> è¡¨ç¤ºé‡‡æ ·é¢‘ç‡èµ«å…¹æ•°ï¼ˆæ¯ç§’é‡‡æ ·å¤šå°‘æ¬¡ï¼‰ï¼Œä»¥æ›´é«˜çš„é¢‘ç‡é‡‡æ ·ä¹Ÿå¯ä»¥ï¼Œä½†ä¼šå¸¦æ¥æ›´å¤šå¼€é”€ï¼›ä»¥ <code>99</code> Hz é‡‡æ ·å¯ä»¥ä¸ CPU æ—¶é’Ÿå‘¨æœŸé”™å¼€ï¼Œé˜²æ­¢é‡‡æ ·åˆ°ä¸€äº›å› æ—¶é’Ÿå‘¨æœŸè€Œäº§ç”Ÿçš„ç‰¹å®šè¡Œä¸º</li><li><code>-p</code> è¡¨ç¤ºè¢«é‡‡æ ·çš„è¿›ç¨‹å·ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªé€—å·åˆ†éš”çš„åˆ—è¡¨ï¼›<code>-t</code> åŒç†ï¼Œè¡¨ç¤ºçº¿ç¨‹å·</li><li><code>-a</code> è¡¨ç¤ºåœ¨æ‰€æœ‰ CPU ä¸Šé‡‡æ ·ï¼Œè‡ª Linux 4.11 å¼€å§‹å·²ç»æ˜¯é»˜è®¤é€‰é¡¹ï¼›é€šè¿‡ <code>-C</code> å¯ä»¥æŒ‡å®š CPU åˆ—è¡¨æˆ–èŒƒå›´é‡‡æ ·</li><li><code>-g</code> è¡¨ç¤ºè®°å½•é‡‡æ ·æ—¶çš„ç¨‹åºè°ƒç”¨æ ˆ</li><li><code>-- sleep 10</code> è¡¨ç¤ºé‡‡æ · 10s</li></ul><p><code>-e</code> å¯ä»¥æŒ‡å®šè®°å½•çš„äº‹ä»¶ã€‚ä»€ä¹ˆäº‹ä»¶éƒ½ä¸æŒ‡å®šæ—¶ï¼Œé»˜è®¤è¿½è¸ª <code>cycles</code> äº‹ä»¶ï¼ˆæ—¶é’Ÿå‘¨æœŸæ•°ï¼‰ã€‚</p><p>é‡‡æ ·ç»“æŸä»¥åï¼Œåœ¨å½“å‰ç›®å½•ä¸‹å°†ä¼šç”Ÿæˆä¸€ä¸ªé‡‡æ ·ç»“æœæ–‡ä»¶ <code>perf.data</code>ï¼ˆç”¨ <code>-o</code> å‚æ•°å¯ä»¥é‡å‘½åï¼‰ã€‚</p><h2 id="references" tabindex="-1"><a class="header-anchor" href="#references"><span>References</span></a></h2><p><a href="https://perf.wiki.kernel.org/index.php/Tutorial#Sampling_with_perf_record" target="_blank" rel="noopener noreferrer">Kernel Wiki - Sampling with perf record</a></p><p><a href="https://man7.org/linux/man-pages/man1/perf-record.1.html" target="_blank" rel="noopener noreferrer">perf-record(1) â€” Linux manual page</a></p><p><a href="https://www.brendangregg.com/perf.html" target="_blank" rel="noopener noreferrer">perf Examples</a></p>`,18)]))}const d=r(c,[["render",o],["__file","Linux Perf Record.html.vue"]]),t=JSON.parse('{"path":"/notes/Performance/Linux%20Perf%20Record.html","title":"Linux Performance - Perf Record","lang":"en-US","frontmatter":{},"headers":[{"level":2,"title":"Background","slug":"background","link":"#background","children":[]},{"level":2,"title":"Usage","slug":"usage","link":"#usage","children":[]},{"level":2,"title":"References","slug":"references","link":"#references","children":[]}],"git":{},"filePathRelative":"notes/Performance/Linux Perf Record.md"}');export{d as comp,t as data};
